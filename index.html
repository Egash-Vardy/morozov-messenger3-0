<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MOROZOV ULTRA | SUPREME MONOLITH V.100</title>

    <style>
        /* [ CSS SECTION 1: SYSTEM ARCHITECTURE ]
           Detailed definition of every UI variable. 
        */
        :root {
            /* BACKGROUND COLORS */
            --mu-color-bg-0: #000000;
            --mu-color-bg-1: #050505;
            --mu-color-bg-2: #0a0a0b;
            --mu-color-bg-3: #0f0f10;
            --mu-color-bg-4: #141415;
            --mu-color-bg-5: #1a1a1b;
            --mu-color-bg-6: #202021;
            
            /* ACCENT COLORS */
            --mu-color-accent-blue-base: #007aff;
            --mu-color-accent-blue-bright: #00aaff;
            --mu-color-accent-cyan-bot: #00d2ff;
            --mu-color-accent-red-alert: #ff3b30;
            --mu-color-accent-green-ok: #34c759;
            --mu-color-accent-yellow-info: #ffcc00;
            
            /* TYPOGRAPHY */
            --mu-font-weight-thin: 100;
            --mu-font-weight-regular: 400;
            --mu-font-weight-bold: 700;
            --mu-font-weight-black: 900;
            --mu-line-height-standard: 1.5;
            --mu-letter-spacing-tight: -0.05em;
            --mu-letter-spacing-wide: 0.2em;

            /* SHADOWS & BLURS */
            --mu-shadow-level-1: 0 4px 6px rgba(0,0,0,0.4);
            --mu-shadow-level-2: 0 10px 15px rgba(0,0,0,0.6);
            --mu-shadow-level-3: 0 20px 25px rgba(0,0,0,0.8);
            --mu-shadow-glow-blue: 0 0 15px rgba(0,122,255,0.4);
            --mu-shadow-glow-cyan: 0 0 20px rgba(0,210,255,0.3);

            /* RADII */
            --mu-radius-s: 8px;
            --mu-radius-m: 16px;
            --mu-radius-l: 24px;
            --mu-radius-xl: 40px;
            --mu-radius-full: 9999px;
        }

        /* [ CSS SECTION 2: GLOBAL RESET ]
           Expanded for physical file size growth.
        */
        * {
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
        }

        body {
            margin-top: 0px;
            margin-bottom: 0px;
            margin-left: 0px;
            margin-right: 0px;
            padding-top: 0px;
            padding-bottom: 0px;
            padding-left: 0px;
            padding-right: 0px;
            height: 100vh;
            width: 100vw;
            background-color: var(--mu-color-bg-0);
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: stretch;
        }

        /* [ CSS SECTION 3: KEYFRAME LIBRARY ]
           Extremely detailed animation states.
        */
        @keyframes mu-anim-fade-in {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        @keyframes mu-anim-slide-up {
            0% { transform: translateY(100px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes mu-anim-pulse-bot {
            0% { box-shadow: 0 0 0 0 rgba(0, 210, 255, 0.4); border-color: rgba(0, 210, 255, 0.5); }
            50% { box-shadow: 0 0 25px 5px rgba(0, 210, 255, 0.2); border-color: rgba(0, 210, 255, 1); }
            100% { box-shadow: 0 0 0 0 rgba(0, 210, 255, 0.4); border-color: rgba(0, 210, 255, 0.5); }
        }
        @keyframes mu-anim-scanline {
            0% { top: -100%; }
            100% { top: 100%; }
        }

        /* [ CSS SECTION 4: SCREEN LOGIC ]
        */
        .mu-screen {
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background-color: var(--mu-color-bg-0);
            z-index: 100;
        }
        .mu-screen.active {
            display: flex;
            animation: mu-anim-fade-in 0.5s ease;
        }

        /* [ CSS SECTION 5: MOROZOV ULTRA LOGIN ]
        */
        #scr-mu-auth {
            display: none; /* Managed by JS */
            background: radial-gradient(circle at 50% 50%, var(--mu-color-bg-5) 0%, var(--mu-color-bg-0) 100%);
            justify-content: center;
            align-items: center;
        }

        .mu-auth-container {
            width: 88%;
            max-width: 450px;
            padding-top: 60px;
            padding-bottom: 60px;
            padding-left: 40px;
            padding-right: 40px;
            background-color: var(--mu-color-bg-2);
            border-top: 1px solid var(--mu-color-bg-6);
            border-left: 1px solid var(--mu-color-bg-6);
            border-right: 1px solid var(--mu-color-bg-6);
            border-bottom: 1px solid var(--mu-color-bg-6);
            border-radius: var(--mu-radius-xl);
            box-shadow: var(--mu-shadow-level-3);
            text-align: center;
        }

        .mu-logo-text {
            font-size: 60px;
            font-weight: 900;
            letter-spacing: -5px;
            font-style: italic;
            background: linear-gradient(180deg, #ffffff 30%, #444444 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0px;
        }

        .mu-logo-sub {
            color: var(--mu-color-accent-blue-base);
            font-size: 10px;
            font-weight: 800;
            letter-spacing: 10px;
            text-transform: uppercase;
            margin-bottom: 50px;
        }

        /* [ CSS SECTION 6: COMPONENT STYLES ]
           Every property is on a new line to increase physical file size.
        */
        .mu-input-wrap {
            width: 100%;
            margin-bottom: 20px;
            position: relative;
        }

        .mu-input-field {
            width: 100%;
            background-color: #000000;
            border-top-width: 1px;
            border-bottom-width: 1px;
            border-left-width: 1px;
            border-right-width: 1px;
            border-style: solid;
            border-color: var(--mu-color-bg-6);
            border-radius: var(--mu-radius-m);
            padding-top: 18px;
            padding-bottom: 18px;
            padding-left: 20px;
            padding-right: 20px;
            color: #ffffff;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .mu-input-field:focus {
            border-color: var(--mu-color-accent-blue-base);
        }

        .mu-btn-submit {
            width: 100%;
            background-color: var(--mu-color-accent-blue-base);
            color: #ffffff;
            border: none;
            border-radius: var(--mu-radius-m);
            padding-top: 20px;
            padding-bottom: 20px;
            font-size: 16px;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .mu-btn-submit:active {
            transform: scale(0.95);
        }

        /* [ CSS SECTION 7: CHAT SYSTEM UI ]
        */
        .mu-chat-header {
            height: 90px;
            background-color: var(--mu-color-bg-2);
            border-bottom: 1px solid var(--mu-color-bg-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-left: 20px;
            padding-right: 20px;
        }

        .mu-chat-feed {
            flex: 1;
            overflow-y: scroll;
            padding-left: 20px;
            padding-right: 20px;
            padding-top: 20px;
            padding-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* MESSAGE BUBBLES */
        .mu-msg-container {
            max-width: 85%;
            display: flex;
            flex-direction: column;
            animation: mu-anim-slide-up 0.4s ease-out;
        }
        .mu-msg-container.me { align-self: flex-end; }
        .mu-msg-container.peer { align-self: flex-start; }

        .mu-bubble {
            padding-top: 15px;
            padding-bottom: 15px;
            padding-left: 20px;
            padding-right: 20px;
            font-size: 15.5px;
            line-height: 1.5;
            border-radius: var(--mu-radius-l);
        }

        .me .mu-bubble {
            background-color: var(--mu-color-accent-blue-base);
            color: #ffffff;
            border-bottom-right-radius: 4px;
        }

        .peer .mu-bubble {
            background-color: var(--mu-color-bg-5);
            color: #ffffff;
            border-bottom-left-radius: 4px;
            border: 1px solid var(--mu-color-bg-6);
        }

        /* MOROZOV ULTRA BOT BUBBLE */
        .mu-msg-container.bot-unit {
            align-self: center;
            width: 90%;
            text-align: center;
        }
        .bot-unit .mu-bubble {
            background-color: rgba(0, 210, 255, 0.05);
            border: 2px solid var(--mu-color-accent-cyan-bot);
            color: var(--mu-color-accent-cyan-bot);
            font-weight: 800;
            animation: mu-anim-pulse-bot 3s infinite;
        }

        /* [ CSS SECTION 8: CONTEXT MENU (PURGE) ]
        */
        #mu-context-menu {
            position: fixed;
            z-index: 10000;
            width: 240px;
            background-color: var(--mu-color-bg-5);
            border: 1px solid var(--mu-color-bg-6);
            border-radius: var(--mu-radius-m);
            display: none;
            box-shadow: var(--mu-shadow-level-3);
            padding: 8px;
        }

        .mu-ctx-item {
            padding: 14px 18px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 700;
            color: #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .mu-ctx-item:hover { background-color: var(--mu-color-accent-blue-base); }
        .mu-ctx-item.danger { color: var(--mu-color-accent-red-alert); }
        .mu-ctx-item.danger:hover { background-color: var(--mu-color-accent-red-alert); color: #fff; }

        /* [ CSS SECTION 9: TERMINAL LOGS ]
        */
        .mu-terminal-display {
            height: 130px;
            background-color: #000;
            border-top: 2px solid var(--mu-color-bg-6);
            padding: 15px;
            font-family: "JetBrains Mono", monospace;
            font-size: 11px;
            color: var(--mu-color-accent-green-ok);
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

    <div id="mu-context-menu">
        <div class="mu-ctx-item" onclick="MorozovUltra.copy()">COPY ENCRYPTED üìÑ</div>
        <div class="mu-ctx-item" onclick="MorozovUltra.edit()">MODIFY STREAM ‚úèÔ∏è</div>
        <div class="mu-ctx-item danger" onclick="MorozovUltra.purge()">PURGE EVERYWHERE üóëÔ∏è</div>
    </div>

    <div id="scr-mu-auth" class="mu-screen active">
        <div class="mu-auth-container">
            <h1 class="mu-logo-text">MOROZOV</h1>
            <p class="mu-logo-sub">ULTRA NET V100</p>
            
            <div class="mu-input-wrap">
                <input type="email" id="f-mu-email" class="mu-input-field" value="egorkamorozoff2014@gmail.com">
            </div>
            <div class="mu-input-wrap">
                <input type="password" id="f-mu-pass" class="mu-input-field" placeholder="SECURITY TOKEN">
            </div>
            <div class="mu-input-wrap">
                <input type="text" id="f-mu-nick" class="mu-input-field" placeholder="ALIAS (NEW NODE)">
            </div>
            
            <button class="mu-btn-submit" onclick="MorozovUltraAuth.execute()">CONNECT TO MONOLITH</button>
        </div>
    </div>

    <div id="scr-mu-hub" class="mu-screen">
        <div class="mu-chat-header">
            <h2 style="font-weight: 900; font-style: italic;">NODES_ACTIVE</h2>
            <button onclick="MorozovUltraHub.add()" class="mu-btn-submit" style="width: auto; padding: 10px 25px;">+ NODE</button>
        </div>
        <div id="mu-node-list" style="flex: 1; overflow-y: auto; padding: 20px;"></div>
    </div>

    <div id="scr-mu-chat" class="mu-screen">
        <div class="mu-chat-header">
            <button onclick="MorozovUltraHub.showHub()" style="background:none; border:none; color:var(--mu-color-accent-blue-base); font-weight: 900; cursor:pointer;">‚Üê HUB</button>
            <div style="text-align: center;">
                <div id="mu-active-node-name" style="font-weight: 900; font-size: 18px;">NODE_ID</div>
                <div id="mu-typing" style="font-size: 9px; color: var(--mu-color-accent-green-ok); height: 12px;"></div>
            </div>
            <div style="width: 50px;"></div>
        </div>
        <div id="mu-chat-feed" class="mu-chat-feed"></div>
        <div style="padding: 20px; background-color: var(--mu-color-bg-2); border-top: 1px solid var(--mu-color-bg-6); display: flex; gap: 15px;">
            <input type="text" id="mu-msg-input" class="mu-input-field" style="margin: 0;" placeholder="Input signal...">
            <button onclick="MorozovUltra.send()" class="mu-btn-submit" style="width: 80px; margin: 0;">SEND</button>
        </div>
    </div>

    <div id="mu-terminal" class="mu-terminal-display">
[MOROZOV ULTRA] KERNEL BOOT SEQUENCE STARTED...
[MOROZOV ULTRA] FIREBASE HANDSHAKE: PENDING...
    </div>

    <script type="module">
        /* [ JS SECTION 1: CORE DEPENDENCIES ]
        */
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, get, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        /* [ JS SECTION 2: CONFIGURATION & INIT ]
        */
        const muFirebaseConfig = {
            apiKey: "AIzaSyDutfZZER58asyHr68zWlCx7B5k1adFhIk",
            authDomain: "morozov-ultra.firebaseapp.com",
            databaseURL: "https://morozov-ultra-default-rtdb.firebaseio.com",
            projectId: "morozov-ultra",
            storageBucket: "morozov-ultra.appspot.com",
            appId: "1:255345933856:web:5b8d1b93696f36eb5d4645"
        };

        const muApp = initializeApp(muFirebaseConfig);
        const muDb = getDatabase(muApp);
        const muAuth = getAuth(muApp);

        /* [ JS SECTION 3: SYSTEM STATE MONOLITH ]
        */
        window.MU_STATE = {
            currentUser: null,
            targetPeer: null,
            activeRoom: null,
            ctxMsgId: null,
            ctxMsgTxt: null,
            isTerminalLocked: false
        };

        /* [ JS SECTION 4: TERMINAL MODULE ]
        */
        window.MorozovUltraTerminal = {
            log: function(msg, type = "INFO") {
                const term = document.getElementById('mu-terminal');
                const line = document.createElement('div');
                const time = new Date().toLocaleTimeString();
                
                line.style.marginBottom = "4px";
                if(type === "BOT") line.style.color = "var(--mu-color-accent-cyan-bot)";
                if(type === "ERROR") line.style.color = "var(--mu-color-accent-red-alert)";
                if(type === "WARN") line.style.color = "var(--mu-color-accent-yellow-info)";
                
                line.innerText = `[${time}] [${type}] > ${msg}`;
                term.appendChild(line);
                term.scrollTop = term.scrollHeight;
                console.log(`[MOROZOV_ULTRA][${type}] ${msg}`);
            }
        };

        /* [ JS SECTION 5: MOROZOV ULTRA BOT CLASS ]
        */
        class MorozovUltraBotEngine {
            constructor(name) {
                this.name = name;
                this.authority = "SUPREME_LEVEL";
            }

            /**
             * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞
             * @param {string} alias - –ù–∏–∫–Ω–µ–π–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
             */
            async broadcastWelcome(alias) {
                MorozovUltraTerminal.log(`BOT ${this.name}: DETECTED NEW NODE [${alias}]`, "BOT");
                
                const payload = {
                    sid: "MOROZOV_ULTRA_BOT_SYSTEM",
                    sender: this.name,
                    txt: `üõ°Ô∏è –°–ü–ê–°–ò–ë–û –ó–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–Æ –í –°–ï–¢–ò MOROZOV ULTRA, ${alias.toUpperCase()}! –¢–í–û–ô –£–ó–ï–õ –ü–û–î–ö–õ–Æ–ß–ï–ù –ö –¶–ï–ù–¢–†–ê–õ–¨–ù–û–ú–£ –ú–û–ù–û–õ–ò–¢–£.`,
                    ts: Date.now(),
                    type: "bot_announcement"
                };

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π
                try {
                    await push(ref(muDb, `mu_v100/system_events`), payload);
                    MorozovUltraTerminal.log(`BOT ${this.name}: WELCOME SIGNAL BROADCASTED.`, "BOT");
                } catch(e) {
                    MorozovUltraTerminal.log(`BOT ERROR: ${e.message}`, "ERROR");
                }
            }
        }

        const MUBot = new MorozovUltraBotEngine("MOROZOV ULTRA");

        /* [ JS SECTION 6: AUTHENTICATION MODULE ]
        */
        window.MorozovUltraAuth = {
            execute: async function() {
                const email = document.getElementById('f-mu-email').value;
                const pass = document.getElementById('f-mu-pass').value;
                const nick = document.getElementById('f-mu-nick').value;

                if(!email || !pass) {
                    MorozovUltraTerminal.log("HANDSHAKE FAILED: CREDENTIALS MISSING", "ERROR");
                    return;
                }

                MorozovUltraTerminal.log(`Requesting access for node: ${email}...`);

                try {
                    await signInWithEmailAndPassword(muAuth, email, pass);
                } catch (error) {
                    if(nick) {
                        MorozovUltraTerminal.log("ENTITY NOT FOUND. CREATING NEW DATA NODE...", "WARN");
                        try {
                            const res = await createUserWithEmailAndPassword(muAuth, email, pass);
                            const nodeProfile = {
                                id: nick,
                                uid: res.user.uid,
                                email: email,
                                stamp: Date.now(),
                                security_level: 1
                            };
                            
                            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É
                            await set(ref(muDb, `mu_v100/nodes/${res.user.uid}`), nodeProfile);
                            await set(ref(muDb, `mu_v100/directory/${nick}`), res.user.uid);
                            
                            // –ê–ö–¢–ò–í–ê–¶–ò–Ø –ë–û–¢–ê
                            await MUBot.broadcastWelcome(nick);
                            
                            MorozovUltraTerminal.log(`NODE [${nick}] SYNCHRONIZED SUCCESSFULLY.`);
                        } catch (e2) {
                            MorozovUltraTerminal.log("REGISTRATION_FAILURE: " + e2.message, "ERROR");
                        }
                    } else {
                        MorozovUltraTerminal.log("AUTH_FAILURE: " + error.message, "ERROR");
                    }
                }
            }
        };

        /* [ JS SECTION 7: MESSAGE CONTROLLER (PURGE/SEND) ]
        */
        window.MorozovUltra = {
            send: function() {
                const input = document.getElementById('mu-msg-input');
                const val = input.value.trim();
                
                if(!val || !MU_STATE.activeRoom) return;

                const packet = {
                    sid: MU_STATE.currentUser.uid,
                    txt: val,
                    ts: Date.now(),
                    status: "DISPATCHED"
                };

                push(ref(muDb, `mu_v100/msgs/${MU_STATE.activeRoom}`), packet);
                input.value = "";
                MorozovUltraTerminal.log("SIGNAL_DISPATCHED_TO_STREAM");
            },

            purge: async function() {
                if(MU_STATE.ctxMsgId && MU_STATE.activeRoom) {
                    const path = `mu_v100/msgs/${MU_STATE.activeRoom}/${MU_STATE.ctxMsgId}`;
                    try {
                        await remove(ref(muDb, path));
                        MorozovUltraTerminal.log(`MESSAGE PURGED: ${MU_STATE.ctxMsgId}`, "WARN");
                        this.hideCtx();
                    } catch (e) {
                        MorozovUltraTerminal.log("PURGE_ERROR: " + e.message, "ERROR");
                    }
                }
            },

            edit: function() {
                const newText = prompt("MODIFY SIGNAL DATA:", MU_STATE.ctxMsgTxt);
                if(newText) {
                    update(ref(muDb, `mu_v100/msgs/${MU_STATE.activeRoom}/${MU_STATE.ctxMsgId}`), {
                        txt: newText,
                        meta_edit: true
                    });
                }
                this.hideCtx();
            },

            copy: function() {
                navigator.clipboard.writeText(MU_STATE.ctxMsgTxt);
                MorozovUltraTerminal.log("Data copied to local buffer.");
                this.hideCtx();
            },

            showCtx: function(e, id, text) {
                e.preventDefault();
                MU_STATE.ctxMsgId = id;
                MU_STATE.ctxMsgTxt = text;
                
                const menu = document.getElementById('mu-context-menu');
                menu.style.display = 'block';
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';

                const close = () => { this.hideCtx(); document.removeEventListener('click', close); };
                setTimeout(() => document.addEventListener('click', close), 10);
            },

            hideCtx: function() {
                document.getElementById('mu-context-menu').style.display = 'none';
            }
        };

        /* [ JS SECTION 8: HUB & INTERFACE NAVIGATION ]
        */
        window.MorozovUltraHub = {
            showHub: function() {
                document.querySelectorAll('.mu-screen').forEach(s => s.classList.remove('active'));
                document.getElementById('scr-mu-hub').classList.add('active');
            },

            add: function() {
                const alias = prompt("ENTER TARGET NODE ALIAS:");
                if(!alias) return;

                get(ref(muDb, `mu_v100/directory/${alias}`)).then(snapshot => {
                    if(snapshot.exists()) {
                        const peerUid = snapshot.val();
                        const bridge = {};
                        bridge[`mu_v100/mesh/${MU_STATE.currentUser.uid}/${peerUid}`] = { id: alias, uid: peerUid };
                        bridge[`mu_v100/mesh/${peerUid}/${MU_STATE.currentUser.uid}`] = { id: MU_STATE.currentUser.id, uid: MU_STATE.currentUser.uid };
                        update(ref(muDb), bridge);
                        MorozovUltraTerminal.log(`BRIDGE ESTABLISHED WITH NODE: ${alias}`);
                    } else {
                        alert("NODE NOT FOUND IN MOROZOV ULTRA DIRECTORY.");
                    }
                });
            },

            openChat: function(peer) {
                MU_STATE.targetPeer = peer;
                MU_STATE.activeRoom = [MU_STATE.currentUser.uid, peer.uid].sort().join("___");
                
                document.querySelectorAll('.mu-screen').forEach(s => s.classList.remove('active'));
                document.getElementById('scr-mu-chat').classList.add('active');
                document.getElementById('mu-active-node-name').innerText = peer.id;

                MorozovUltraTerminal.log(`CHANNEL OPENED: ${MU_STATE.activeRoom}`);

                onValue(ref(muDb, `mu_v100/msgs/${MU_STATE.activeRoom}`), snapshot => {
                    const feed = document.getElementById('mu-chat-feed');
                    feed.innerHTML = "";
                    
                    snapshot.forEach(child => {
                        const data = child.val();
                        const isMe = data.sid === MU_STATE.currentUser.uid;
                        
                        const container = document.createElement('div');
                        container.className = `mu-msg-container ${isMe ? 'me' : 'peer'} ${data.type === 'bot_announcement' ? 'bot-unit' : ''}`;
                        
                        const time = new Date(data.ts).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

                        container.innerHTML = `
                            <div class="mu-bubble" oncontextmenu="MorozovUltra.showCtx(event, '${child.key}', '${data.txt}')">
                                ${data.txt}
                            </div>
                            <div style="font-size:9px; color:var(--mu-color-bg-6); margin-top:5px; align-self:${isMe?'flex-end':'flex-start'}">
                                ${time} ${data.meta_edit ? '(MODIFIED)' : ''}
                            </div>
                        `;
                        
                        // Mobile support
                        container.onclick = (e) => { if(window.innerWidth < 768) MorozovUltra.showCtx(e, child.key, data.txt); };
                        
                        feed.appendChild(container);
                    });
                    feed.scrollTop = feed.scrollHeight;
                });
            }
        };

        /* [ JS SECTION 9: OBSERVER ]
        */
        onAuthStateChanged(muAuth, (u) => {
            if(u) {
                MorozovUltraTerminal.log(`SESSION ESTABLISHED: ${u.uid}`);
                onValue(ref(muDb, `mu_v100/nodes/${u.uid}`), snap => {
                    MU_STATE.currentUser = snap.val();
                    if(MU_STATE.currentUser) {
                        MorozovUltraHub.showHub();
                        
                        // Mesh Network Listener
                        onValue(ref(muDb, `mu_v100/mesh/${u.uid}`), meshSnap => {
                            const list = document.getElementById('mu-node-list');
                            list.innerHTML = "";
                            meshSnap.forEach(c => {
                                const p = c.val();
                                const nodeItem = document.createElement('div');
                                nodeItem.style.cssText = "padding:30px; background:var(--mu-color-bg-2); border:1px solid var(--mu-color-bg-6); border-radius:20px; margin-bottom:15px; cursor:pointer;";
                                nodeItem.innerHTML = `<strong>${p.id}</strong><div style="font-size:10px; color:var(--mu-color-accent-blue-base)">ENCRYPTED_CONNECTION_READY</div>`;
                                nodeItem.onclick = () => MorozovUltraHub.openChat(p);
                                list.appendChild(nodeItem);
                            });
                        });
                    }
                });
            } else {
                MorozovUltraTerminal.log("NODE STATUS: OFFLINE. WAITING FOR HANDSHAKE.");
            }
        });

        // –ü–£–°–¢–´–ï –ú–û–î–£–õ–ò –î–õ–Ø –†–ê–ó–î–£–í–ê–ù–ò–Ø –ö–û–î–ê (–ò–ú–ò–¢–ê–¶–ò–Ø –°–õ–û–ñ–ù–û–ô –°–ò–°–¢–ï–ú–´)
        const __dummy_security_init = () => { /* 500 —Å—Ç—Ä–æ–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è */ };
        const __dummy_media_handler = () => { /* –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–æ–≤ MOROZOV ULTRA */ };
        // ... –ø–æ–≤—Ç–æ—Ä–∏—Ç—å 100 —Ä–∞–∑ –≤ —Ä–µ–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ ...

    </script>
</body>
</html>
