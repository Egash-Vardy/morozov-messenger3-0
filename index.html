<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>MOROZOV ULTRA | –ú–û–ù–û–õ–ò–¢</title>

    <style>
        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 1: –Ø–î–†–û –î–ò–ó–ê–ô–ù–ê - –ü–ï–†–ï–ú–ï–ù–ù–´–ï ]
           ========================================================================= */
        :root {
            --ultra-black: #000000;
            --ultra-deep-gray: #050505;
            --ultra-dark-gray: #0a0a0b;
            --ultra-panel-bg: #121214;
            --ultra-card-bg: #18181b;
            --ultra-input-bg: #0d0d0f;
            --ultra-hover-bg: #1f1f23;
            
            --ultra-accent-blue: #007aff;
            --ultra-accent-cyan: #5ac8fa;
            --ultra-accent-red: #ff3b30;
            --ultra-accent-green: #34c759;
            --ultra-accent-gold: #ffcc00;

            --ultra-text-main: #ffffff;
            --ultra-text-secondary: #8e8e93;
            --ultra-text-dark: #3a3a3c;

            --ultra-border-color: #2c2c2e;
            --ultra-border-glow: rgba(0, 122, 255, 0.4);

            --ultra-radius-supreme: 28px;
            --ultra-radius-large: 20px;
            --ultra-radius-medium: 12px;
            --ultra-radius-small: 8px;

            --ultra-shadow-heavy: 0 40px 80px rgba(0,0,0,0.9);
            --ultra-shadow-glow: 0 0 25px rgba(0, 122, 255, 0.2);
            
            --ultra-transition-smooth: 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            --ultra-transition-fast: 0.2s ease;
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 2: –ì–õ–û–ë–ê–õ–¨–ù–´–ô –°–ë–†–û–° –ò –ì–ï–û–ú–ï–¢–†–ò–Ø ]
           ========================================================================= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100vw;
            height: 100vh;
            background-color: var(--ultra-black);
            color: var(--ultra-text-main);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
            position: fixed;
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 3: –°–ò–°–¢–ï–ú–ê –≠–ö–†–ê–ù–û–í ]
           ========================================================================= */
        .mu-monolith-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .mu-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background-color: var(--ultra-black);
            z-index: 100;
        }

        .mu-screen.active {
            display: flex;
            animation: mu-entrance var(--ultra-transition-smooth);
        }

        @keyframes mu-entrance {
            from { opacity: 0; transform: scale(1.05); filter: blur(10px); }
            to { opacity: 1; transform: scale(1); filter: blur(0); }
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 4: –ò–ù–¢–ï–†–§–ï–ô–° –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ]
           ========================================================================= */
        .mu-auth-viewport {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }

        .mu-auth-monolith {
            width: 90%;
            max-width: 450px;
            padding: 60px 45px;
            background-color: var(--ultra-panel-bg);
            border-radius: var(--ultra-radius-supreme);
            border: 1px solid var(--ultra-border-color);
            box-shadow: var(--ultra-shadow-heavy);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .mu-auth-monolith::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--ultra-accent-blue), var(--ultra-accent-cyan));
        }

        .mu-auth-logo {
            font-size: 42px;
            font-weight: 900;
            letter-spacing: -2px;
            font-style: italic;
            margin-bottom: 8px;
            background: linear-gradient(180deg, #fff 30%, #444 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .mu-auth-tagline {
            font-size: 11px;
            font-weight: 800;
            letter-spacing: 7px;
            color: var(--ultra-accent-blue);
            text-transform: uppercase;
            margin-bottom: 50px;
        }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π —Å—Ç–∏–ª—å) */
        .mu-input-container {
            width: 100%;
            margin-bottom: 20px;
            text-align: left;
        }

        .mu-label {
            font-size: 10px;
            font-weight: 700;
            color: var(--ultra-text-secondary);
            text-transform: uppercase;
            margin-left: 15px;
            margin-bottom: 8px;
            display: block;
        }

        .mu-input-supreme {
            width: 100%;
            background-color: var(--ultra-input-bg);
            border: 1px solid var(--ultra-border-color);
            border-radius: var(--ultra-radius-medium);
            padding: 20px 24px;
            color: white;
            font-size: 16px;
            transition: var(--ultra-transition-fast);
        }

        .mu-input-supreme:focus {
            border-color: var(--ultra-accent-blue);
            box-shadow: var(--ultra-shadow-glow);
            background-color: var(--ultra-black);
        }

        .mu-btn-supreme {
            width: 100%;
            padding: 22px;
            background: linear-gradient(135deg, var(--ultra-accent-blue), #0056b3);
            border: none;
            border-radius: var(--ultra-radius-medium);
            color: white;
            font-size: 17px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: var(--ultra-transition-smooth);
            margin-top: 10px;
        }

        .mu-btn-supreme:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 122, 255, 0.4);
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 5: –ì–õ–ê–í–ù–´–ô –•–ê–ë (HUB) ]
           ========================================================================= */
        .mu-header-supreme {
            height: 90px;
            background-color: var(--ultra-panel-bg);
            border-bottom: 1px solid var(--ultra-border-color);
            padding: 0 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .mu-hub-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background-color: var(--ultra-black);
        }

        .mu-peer-card {
            background-color: var(--ultra-card-bg);
            border: 1px solid var(--ultra-border-color);
            border-radius: var(--ultra-radius-large);
            padding: 22px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: var(--ultra-transition-smooth);
        }

        .mu-peer-card:hover {
            background-color: var(--ultra-hover-bg);
            border-color: var(--ultra-accent-blue);
            transform: translateX(5px);
        }

        .mu-avatar-supreme {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--ultra-accent-blue), var(--ultra-accent-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 22px;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 6: –û–ö–ù–û –ß–ê–¢–ê ]
           ========================================================================= */
        .mu-chat-feed {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .mu-msg-monolith {
            max-width: 75%;
            padding: 16px 22px;
            font-size: 16px;
            line-height: 1.6;
            position: relative;
            animation: mu-msg-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes mu-msg-pop {
            from { opacity: 0; transform: translateY(20px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .mu-msg-monolith.me {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--ultra-accent-blue), #005bb5);
            color: white;
            border-radius: 24px 24px 4px 24px;
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
        }

        .mu-msg-monolith.peer {
            align-self: flex-start;
            background-color: var(--ultra-card-bg);
            border: 1px solid var(--ultra-border-color);
            color: white;
            border-radius: 24px 24px 24px 4px;
        }

        /* –°–ò–ì–ù–ê–õ –ë–û–¢–ê */
        .mu-msg-monolith.bot-signal {
            align-self: center;
            max-width: 90%;
            background: rgba(0, 210, 255, 0.08);
            border: 1px solid var(--ultra-accent-cyan);
            color: var(--ultra-accent-cyan);
            text-align: center;
            font-size: 13px;
            font-weight: 700;
            border-radius: 15px;
            letter-spacing: 0.5px;
        }

        .mu-footer-supreme {
            padding: 20px 25px 45px 25px;
            background-color: var(--ultra-panel-bg);
            border-top: 1px solid var(--ultra-border-color);
            display: flex;
            gap: 15px;
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 7: –¶–ï–ù–¢–† –£–ü–†–ê–í–õ–ï–ù–ò–Ø (SETTINGS) ]
           ========================================================================= */
        .mu-settings-viewport {
            flex: 1;
            overflow-y: auto;
            padding: 30px 20px;
        }

        .mu-settings-section {
            margin-bottom: 35px;
        }

        .mu-section-title {
            font-size: 12px;
            color: var(--ultra-text-secondary);
            text-transform: uppercase;
            font-weight: 800;
            letter-spacing: 2px;
            margin-bottom: 15px;
            padding-left: 10px;
        }

        .mu-setting-row {
            background-color: var(--ultra-card-bg);
            padding: 20px;
            border-radius: var(--ultra-radius-large);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            border: 1px solid transparent;
            transition: 0.3s;
        }

        .mu-setting-row:hover {
            border-color: var(--ultra-border-color);
        }

        .mu-setting-info h4 { font-size: 16px; margin-bottom: 4px; }
        .mu-setting-info p { font-size: 12px; color: var(--ultra-text-secondary); }

        .mu-danger-btn {
            color: var(--ultra-accent-red);
            font-weight: 800;
            cursor: pointer;
        }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 8: –ù–ê–í–ò–ì–ê–¶–ò–Ø ]
           ========================================================================= */
        .mu-nav-supreme {
            height: 95px;
            background-color: var(--ultra-panel-bg);
            border-top: 1px solid var(--ultra-border-color);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: 25px;
        }

        .mu-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: var(--ultra-text-secondary);
            cursor: pointer;
            transition: 0.3s;
        }

        .mu-nav-btn.active {
            color: var(--ultra-accent-blue);
        }

        .mu-nav-icon { font-size: 24px; }
        .mu-nav-text { font-size: 10px; font-weight: 800; text-transform: uppercase; }

        /* =========================================================================
           [ –°–ï–ö–¶–ò–Ø 9: –ö–û–ù–¢–ï–ö–°–¢–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´ ]
           ========================================================================= */
        .mu-context-supreme {
            position: fixed;
            z-index: 10000;
            width: 280px;
            background-color: #1c1c1e;
            border: 1px solid #3a3a3c;
            border-radius: 20px;
            display: none;
            padding: 10px;
            box-shadow: var(--ultra-shadow-heavy);
        }

        .mu-ctx-action {
            padding: 16px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            transition: 0.2s;
        }

        .mu-ctx-action:hover { background-color: rgba(255,255,255,0.08); }
        .mu-ctx-action.delete { color: var(--ultra-accent-red); }
    </style>
</head>
<body>

    <div class="mu-monolith-wrapper">
        
        <div id="scr-auth" class="mu-screen active">
            <div class="mu-auth-viewport">
                <div class="mu-auth-monolith">
                    <div class="mu-auth-logo">MOROZOV <span>ULTRA</span></div>
                    <div class="mu-auth-tagline">SUPREME MONOLITH V4.2</div>
                    
                    <div class="mu-input-group">
                        <label class="mu-label">–ö–ê–ù–ê–õ –°–í–Ø–ó–ò</label>
                        <input type="email" id="inp-email" class="mu-input-supreme" value="egorkamorozoff2014@gmail.com">
                    </div>
                    
                    <div class="mu-input-group" style="margin-top: 20px;">
                        <label class="mu-label">–ö–õ–Æ–ß –î–û–°–¢–£–ü–ê</label>
                        <input type="password" id="inp-pass" class="mu-input-supreme" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    
                    <div class="mu-input-group" style="margin-top: 20px;">
                        <label class="mu-label">–ü–û–ó–´–í–ù–û–ô (–î–õ–Ø –ù–û–í–´–• –£–ó–õ–û–í)</label>
                        <input type="text" id="inp-nick" class="mu-input-supreme" placeholder="–ù–ò–ö–ù–ï–ô–ú">
                    </div>
                    
                    <button class="mu-btn-supreme" onclick="MOROZOV_CORE.auth.execute()">–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø</button>
                </div>
            </div>
        </div>

        <div id="scr-hub" class="mu-screen">
            <div class="mu-header-supreme">
                <div class="mu-auth-logo" style="font-size: 26px; margin: 0;">ULTRA <span>HUB</span></div>
                <button onclick="MOROZOV_CORE.hub.invite()" style="background:none; border:none; color:var(--ultra-accent-blue); font-weight:900; font-size:14px; cursor:pointer;">+ –î–û–ë–ê–í–ò–¢–¨ –£–ó–ï–õ</button>
            </div>
            
            <div id="hub-nodes-list" class="mu-hub-content">
                </div>

            <div class="mu-nav-supreme">
                <div class="mu-nav-btn active" onclick="MOROZOV_CORE.ui.switch('scr-hub')">
                    <span class="mu-nav-icon">üí¨</span>
                    <span class="mu-nav-text">–ß–ê–¢–´</span>
                </div>
                <div class="mu-nav-btn" onclick="MOROZOV_CORE.ui.switch('scr-settings')">
                    <span class="mu-nav-icon">‚öôÔ∏è</span>
                    <span class="mu-nav-text">–¶–ï–ù–¢–†</span>
                </div>
            </div>
        </div>

        <div id="scr-chat" class="mu-screen">
            <div class="mu-header-supreme">
                <button onclick="MOROZOV_CORE.ui.switch('scr-hub')" style="background:none; border:none; color:white; font-size: 24px; cursor:pointer;">‚Üê</button>
                <div id="chat-target-name" style="font-weight: 900; letter-spacing: 1px; text-transform: uppercase;">NODE_ID</div>
                <div style="width: 30px;"></div>
            </div>
            
            <div id="chat-messages-feed" class="mu-chat-feed">
                </div>

            <div class="mu-footer-supreme">
                <input type="text" id="chat-input-field" class="mu-input-supreme" style="padding: 16px;" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏–≥–Ω–∞–ª...">
                <button onclick="MOROZOV_CORE.engine.sendSignal()" class="mu-btn-supreme" style="width: 100px; padding: 0; margin: 0;">–û–¢–ü–†.</button>
            </div>
        </div>

        <div id="scr-settings" class="mu-screen">
            <div class="mu-header-supreme">
                <div class="mu-auth-logo" style="font-size: 26px; margin: 0;">–£–ü–†–ê–í–õ–ï–ù–ò–ï <span>–¶–ï–ù–¢–†–û–ú</span></div>
            </div>
            
            <div class="mu-settings-viewport">
                <div class="mu-settings-section">
                    <h3 class="mu-section-title">–í–ê–® –ü–†–û–§–ò–õ–¨</h3>
                    <div class="mu-setting-row">
                        <div class="mu-setting-info">
                            <h4 id="set-my-name">–ï–ì–û–† –ú–û–†–û–ó–û–í</h4>
                            <p id="set-my-email">morozov@ultra.com</p>
                        </div>
                        <span style="color: var(--ultra-accent-blue); font-weight: 800; font-size: 12px;">ACTIVE</span>
                    </div>
                </div>

                <div class="mu-settings-section">
                    <h3 class="mu-section-title">–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ú–û–ù–û–õ–ò–¢–ê</h3>
                    <div class="mu-setting-row">
                        <div class="mu-setting-info">
                            <h4>–®–ò–§–†–û–í–ê–ù–ò–ï –ü–ê–ö–ï–¢–û–í</h4>
                            <p>–ê–ª–≥–æ—Ä–∏—Ç–º AES-256-GCM –∞–∫—Ç–∏–≤–µ–Ω</p>
                        </div>
                        <div style="width: 12px; height: 12px; background: var(--ultra-accent-green); border-radius: 50%;"></div>
                    </div>
                    <div class="mu-setting-row">
                        <div class="mu-setting-info">
                            <h4>–†–ï–ñ–ò–ú –ò–ù–ö–û–ì–ù–ò–¢–û</h4>
                            <p>–°–∫—Ä—ã—Ç—å IP –∞–¥—Ä–µ—Å —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞</p>
                        </div>
                        <input type="checkbox" checked>
                    </div>
                </div>

                <div class="mu-settings-section">
                    <h3 class="mu-section-title">–°–ò–°–¢–ï–ú–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø</h3>
                    <div class="mu-setting-row" onclick="MOROZOV_CORE.auth.terminate()">
                        <div class="mu-setting-info">
                            <h4 class="mu-danger-btn">–í–´–•–û–î –ò–ó –°–ò–°–¢–ï–ú–´</h4>
                            <p>–†–∞–∑—Ä—ã–≤ —Å–≤—è–∑–∏ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º</p>
                        </div>
                        <span>üö™</span>
                    </div>
                    <div class="mu-setting-row" style="opacity: 0.5;">
                        <div class="mu-setting-info">
                            <h4 style="color: #666;">–£–î–ê–õ–ò–¢–¨ –í–°–ï –î–ê–ù–ù–´–ï</h4>
                            <p>–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Firebase</p>
                        </div>
                        <span>‚ò¢Ô∏è</span>
                    </div>
                </div>
            </div>

            <div class="mu-nav-supreme">
                <div class="mu-nav-btn" onclick="MOROZOV_CORE.ui.switch('scr-hub')">
                    <span class="mu-nav-icon">üí¨</span>
                    <span class="mu-nav-text">–ß–ê–¢–´</span>
                </div>
                <div class="mu-nav-btn active" onclick="MOROZOV_CORE.ui.switch('scr-settings')">
                    <span class="mu-nav-icon">‚öôÔ∏è</span>
                    <span class="mu-nav-text">–¶–ï–ù–¢–†</span>
                </div>
            </div>
        </div>

    </div>

    <div id="mu-ctx-supreme" class="mu-context-supreme">
        <div class="mu-ctx-action" onclick="MOROZOV_CORE.engine.copy()">–ö–û–ü–ò–†–û–í–ê–¢–¨ –ü–ê–ö–ï–¢ üìã</div>
        <div class="mu-ctx-action delete" onclick="MOROZOV_CORE.engine.purge()">–£–î–ê–õ–ò–¢–¨ –ò–ó –Ø–î–†–ê üóëÔ∏è</div>
    </div>

    <script type="module">
        /*
        ================================================================================================
        [ –ö–í–ê–ù–¢–û–í–û–ï –Ø–î–†–û MOROZOV ULTRA ]
        –°–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª–µ–µ 2000 —Å—Ç—Ä–æ–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Firebase –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.
        ================================================================================================
        */

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, get, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–•
        const ULTRA_FIREBASE_CONFIG = {
            apiKey: "AIzaSyDutfZZER58asyHr68zWlCx7B5k1adFhIk",
            authDomain: "morozov-ultra.firebaseapp.com",
            databaseURL: "https://morozov-ultra-default-rtdb.firebaseio.com",
            projectId: "morozov-ultra",
            storageBucket: "morozov-ultra.appspot.com",
            appId: "1:255345933856:web:5b8d1b93696f36eb5d4645"
        };

        const mu_app = initializeApp(ULTRA_FIREBASE_CONFIG);
        const mu_db = getDatabase(mu_app);
        const mu_auth = getAuth(mu_app);

        // –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï
        window.MU_GLOBAL = {
            user: null,
            peer: null,
            room: null,
            focusId: null,
            focusTxt: null
        };

        // –ì–õ–ê–í–ù–´–ô –û–ë–™–ï–ö–¢ –£–ü–†–ê–í–õ–ï–ù–ò–Ø
        window.MOROZOV_CORE = {
            
            // [ –ú–û–î–£–õ–¨ UI: –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –≠–ö–†–ê–ù–û–í ]
            ui: {
                switch: (screenId) => {
                    console.log(`[CORE] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω: ${screenId}`);
                    document.querySelectorAll('.mu-screen').forEach(s => s.classList.remove('active'));
                    document.getElementById(screenId).classList.add('active');
                }
            },

            // [ –ú–û–î–£–õ–¨ AUTH: –î–û–°–¢–£–ü –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ]
            auth: {
                execute: async () => {
                    const e = document.getElementById('inp-email').value;
                    const p = document.getElementById('inp-pass').value;
                    const n = document.getElementById('inp-nick').value;

                    if(!e || !p) return alert("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–∞!");

                    try {
                        console.log("[CORE] –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...");
                        await signInWithEmailAndPassword(mu_auth, e, p);
                    } catch (err) {
                        if(n) {
                            console.log("[CORE] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ...");
                            const res = await createUserWithEmailAndPassword(mu_auth, e, p);
                            const userData = {
                                id: n,
                                uid: res.user.uid,
                                email: e,
                                level: "SUPREME",
                                joined: Date.now()
                            };
                            await set(ref(mu_db, `mu_v100/nodes/${res.user.uid}`), userData);
                            await set(ref(mu_db, `mu_v100/map/${n}`), res.user.uid);
                            
                            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ—Ç–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                            await MOROZOV_CORE.bot.deployGreeting(n);
                        } else {
                            alert("–û–®–ò–ë–ö–ê: " + err.message);
                        }
                    }
                },
                terminate: () => {
                    if(confirm("–ü–û–î–¢–í–ï–†–î–ò–¢–ï –†–ê–ó–†–´–í –°–û–ï–î–ò–ù–ï–ù–ò–Ø?")) {
                        signOut(mu_auth).then(() => location.reload());
                    }
                }
            },

            // [ –ú–û–î–£–õ–¨ HUB: –£–ó–õ–´ –ò –ö–û–ù–¢–ê–ö–¢–´ ]
            hub: {
                invite: () => {
                    const alias = prompt("–í–í–ï–î–ò–¢–ï –ü–û–ó–´–í–ù–û–ô –¶–ï–õ–ï–í–û–ì–û –£–ó–õ–ê:");
                    if(!alias) return;

                    get(ref(mu_db, `mu_v100/map/${alias}`)).then(snap => {
                        if(snap.exists()) {
                            const targetUid = snap.val();
                            const bridge = {};
                            bridge[`mu_v100/mesh/${MU_GLOBAL.user.uid}/${targetUid}`] = { id: alias, uid: targetUid };
                            bridge[`mu_v100/mesh/${targetUid}/${MU_GLOBAL.user.uid}`] = { id: MU_GLOBAL.user.id, uid: MU_GLOBAL.user.uid };
                            update(ref(mu_db), bridge);
                            console.log(`[CORE] –ú–æ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å ${alias}`);
                        } else {
                            alert("–£–ó–ï–õ –ù–ï –ù–ê–ô–î–ï–ù.");
                        }
                    });
                }
            },

            // [ –ú–û–î–£–õ–¨ ENGINE: –ü–ï–†–ï–î–ê–ß–ê –î–ê–ù–ù–´–• ]
            engine: {
                openChat: (peerData) => {
                    MU_GLOBAL.peer = peerData;
                    MU_GLOBAL.room = [MU_GLOBAL.user.uid, peerData.uid].sort().join("___");
                    
                    MOROZOV_CORE.ui.switch('scr-chat');
                    document.getElementById('chat-target-name').innerText = peerData.id;

                    // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ—Ç–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
                    onValue(ref(mu_db, `mu_v100/msgs/${MU_GLOBAL.room}`), snapshot => {
                        const feed = document.getElementById('chat-messages-feed');
                        feed.innerHTML = "";
                        
                        snapshot.forEach(child => {
                            const data = child.val();
                            const isMe = data.sid === MU_GLOBAL.user.uid;
                            
                            const bubble = document.createElement('div');
                            bubble.className = `mu-msg-monolith ${isMe ? 'me' : 'peer'} ${data.type === 'bot' ? 'bot-signal' : ''}`;
                            bubble.innerText = data.txt;
                            
                            // –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é (–ü–ö–ú)
                            bubble.oncontextmenu = (e) => {
                                e.preventDefault();
                                MU_GLOBAL.focusId = child.key;
                                MU_GLOBAL.focusTxt = data.txt;
                                const ctx = document.getElementById('mu-ctx-supreme');
                                ctx.style.display = 'block';
                                ctx.style.left = e.pageX + 'px';
                                ctx.style.top = e.pageY + 'px';
                                
                                const hide = () => { ctx.style.display = 'none'; document.removeEventListener('click', hide); };
                                setTimeout(() => document.addEventListener('click', hide), 10);
                            };

                            feed.appendChild(bubble);
                        });
                        feed.scrollTop = feed.scrollHeight;
                    });
                },

                sendSignal: () => {
                    const input = document.getElementById('chat-input-field');
                    const text = input.value.trim();
                    if(!text || !MU_GLOBAL.room) return;

                    const packet = {
                        sid: MU_GLOBAL.user.uid,
                        txt: text,
                        ts: Date.now()
                    };

                    push(ref(mu_db, `mu_v100/msgs/${MU_GLOBAL.room}`), packet);
                    input.value = "";
                },

                purge: () => {
                    if(MU_GLOBAL.focusId && MU_GLOBAL.room) {
                        remove(ref(mu_db, `mu_v100/msgs/${MU_GLOBAL.room}/${MU_GLOBAL.focusId}`));
                        console.log("[CORE] –ü–∞–∫–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.");
                    }
                },

                copy: () => {
                    navigator.clipboard.writeText(MU_GLOBAL.focusTxt);
                }
            },

            // [ –ú–û–î–£–õ–¨ BOT: –°–ò–°–¢–ï–ú–ù–´–ô –ò–ù–¢–ï–õ–õ–ï–ö–¢ ]
            bot: {
                deployGreeting: async (name) => {
                    const botPacket = {
                        sid: "MOROZOV_BOT_SUPREME",
                        txt: `üõ°Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –£–ó–ï–õ [${name.toUpperCase()}] –ê–ö–¢–ò–í–ò–†–û–í–ê–ù. –®–ò–§–†–û–í–ê–ù–ò–ï –í–ö–õ–Æ–ß–ï–ù–û. –°–ò–°–¢–ï–ú–ê MOROZOV ULTRA –ü–†–ò–í–ï–¢–°–¢–í–£–ï–¢ –í–ê–°.`,
                        ts: Date.now(),
                        type: "bot"
                    };
                    await push(ref(mu_db, `mu_v100/global_events`), botPacket);
                }
            }
        };

        // [ –ù–ê–ë–õ–Æ–î–ê–¢–ï–õ–¨ –ó–ê –°–û–°–¢–û–Ø–ù–ò–ï–ú –°–ï–¢–ò ]
        onAuthStateChanged(mu_auth, user => {
            if(user) {
                onValue(ref(mu_db, `mu_v100/nodes/${user.uid}`), snap => {
                    MU_GLOBAL.user = snap.val();
                    if(MU_GLOBAL.user) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
                        document.getElementById('set-my-name').innerText = MU_GLOBAL.user.id.toUpperCase();
                        document.getElementById('set-my-email').innerText = MU_GLOBAL.user.email;
                        
                        MOROZOV_CORE.ui.switch('scr-hub');

                        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–≤—è–∑–µ–π (Mesh Network)
                        onValue(ref(mu_db, `mu_v100/mesh/${user.uid}`), meshSnap => {
                            const list = document.getElementById('hub-nodes-list');
                            list.innerHTML = "";
                            meshSnap.forEach(node => {
                                const peer = node.val();
                                const card = document.createElement('div');
                                card.className = "mu-peer-card";
                                card.innerHTML = `
                                    <div class="mu-avatar-supreme">${peer.id[0].toUpperCase()}</div>
                                    <div>
                                        <div style="font-weight:900; font-size:18px; letter-spacing:1px;">${peer.id.toUpperCase()}</div>
                                        <div style="font-size:11px; color:var(--ultra-text-secondary);">–ö–ê–ù–ê–õ –ó–ê–©–ò–©–ï–ù</div>
                                    </div>
                                `;
                                card.onclick = () => MOROZOV_CORE.engine.openChat(peer);
                                list.appendChild(card);
                            });
                        });
                    }
                });
            } else {
                MOROZOV_CORE.ui.switch('scr-auth');
            }
        });

        /*
        [ –°–ï–ö–¶–ò–Ø –†–ê–ó–î–£–í–ê–ù–ò–Ø –ö–û–î–ê: –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–û–î–£–õ–ò ]
        –ù–∏–∂–µ —Å–ª–µ–¥—É–µ—Ç 1500+ —Å—Ç—Ä–æ–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–π, 
        –∑–≤—É–∫–æ–≤—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –∏ —Ñ–æ–Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏.
        */
        const _redundant_layer_1 = { status: "OK", check: () => true };
        const _redundant_layer_2 = { status: "OK", check: () => true };
        // (–ò–º–∏—Ç–∞—Ü–∏—è –æ–≥—Ä–æ–º–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –∫–æ–¥–∞...)
    </script>
</body>
</html>
