<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>MOROZOV ULTRA | ABSOLUTE</title>

    <style>
        /* [ –ú–û–î–£–õ–¨ 1: –ì–õ–û–ë–ê–õ–¨–ù–´–ô –î–í–ò–ñ–û–ö –ü–ï–†–ï–ú–ï–ù–ù–´–• ] 
        */
        :root {
            --m-bg: #000000;
            --m-surface: #0a0a0b;
            --m-panel: #111112;
            --m-card: #18181b;
            --m-accent: #007aff;
            --m-accent-rgb: 0, 122, 255;
            --m-text: #ffffff;
            --m-text-dim: #8e8e93;
            --m-border: #242426;
            --m-input: #050505;
            --m-shadow: rgba(0, 0, 0, 0.9);
            --m-glow: 0 0 20px rgba(0, 122, 255, 0.4);
            --m-grad: linear-gradient(135deg, #007aff, #004599);
            --m-radius: 24px;
            --m-anim: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* [ –ú–û–î–£–õ–¨ 2: ULTRA-WHITE PLATINUM EDITION ] 
        */
        [data-theme="white"] {
            --m-bg: #f2f2f7;
            --m-surface: #ffffff;
            --m-panel: #fcfcfd;
            --m-card: #ffffff;
            --m-accent: #007aff;
            --m-text: #1d1d1f;
            --m-text-dim: #86868b;
            --m-border: #d1d1d6;
            --m-input: #e5e5ea;
            --m-shadow: rgba(0, 0, 0, 0.05);
            --m-glow: 0 0 20px rgba(0, 122, 255, 0.2);
            --m-grad: linear-gradient(135deg, #007aff, #5856d6);
        }

        /* [ –ú–û–î–£–õ–¨ 3: –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –ò –°–ö–†–û–õ–õ ] 
        */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--m-bg);
            color: var(--m-text);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            transition: background 0.6s var(--m-anim);
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--m-accent); border-radius: 10px; }

        /* [ –ú–û–î–£–õ–¨ 4: –°–ò–°–¢–ï–ú–ê –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ô (VIEWPORT) ] 
        */
        .u-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background: var(--m-bg);
            z-index: 10;
        }

        .u-screen.active {
            display: flex;
            animation: screenIn 0.5s var(--m-anim);
        }

        @keyframes screenIn {
            from { opacity: 0; transform: scale(1.05) translateY(30px); filter: blur(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); }
        }

        /* [ –ú–û–î–£–õ–¨ 5: –ö–û–ú–ü–û–ù–ï–ù–¢–´ - –®–ê–ü–ö–ê ] 
        */
        .u-header {
            height: 120px;
            background: var(--m-surface);
            border-bottom: 1px solid var(--m-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            box-shadow: 0 10px 30px var(--m-shadow);
            z-index: 100;
        }

        .u-logo {
            font-size: 28px;
            font-weight: 900;
            letter-spacing: -1.5px;
            text-transform: uppercase;
        }

        .u-logo span {
            color: var(--m-accent);
            text-shadow: 0 0 15px var(--m-glow);
        }

        .u-status-pill {
            background: rgba(var(--m-accent-rgb), 0.1);
            color: var(--m-accent);
            padding: 8px 16px;
            border-radius: 40px;
            font-size: 10px;
            font-weight: 800;
            border: 1px solid var(--m-accent);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* [ –ú–û–î–£–õ–¨ 6: –ö–û–ú–ü–û–ù–ï–ù–¢–´ - –°–ö–ê–ù–ï–† (–í –î–†) ] 
        */
        .u-scanner-zone {
            padding: 30px 40px;
            background: var(--m-panel);
            border-bottom: 1px solid var(--m-border);
        }

        .u-search-wrap {
            display: flex;
            gap: 15px;
            background: var(--m-input);
            padding: 8px;
            border-radius: 20px;
            border: 2px solid var(--m-border);
            transition: 0.4s var(--m-anim);
        }

        .u-search-wrap:focus-within {
            border-color: var(--m-accent);
            box-shadow: var(--m-glow);
        }

        .u-field {
            flex: 1;
            background: transparent;
            border: none;
            padding: 15px 20px;
            color: var(--m-text);
            font-size: 17px;
            outline: none;
            font-weight: 500;
        }

        .u-btn-main {
            background: var(--m-accent);
            color: #fff;
            border: none;
            padding: 0 35px;
            border-radius: 14px;
            font-weight: 900;
            font-size: 14px;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.3s;
        }

        .u-btn-main:active {
            transform: scale(0.92);
            filter: brightness(0.8);
        }

        /* [ –ú–û–î–£–õ–¨ 7: –°–ü–ò–°–û–ö –£–ó–õ–û–í ] 
        */
        .u-main-scroll {
            flex: 1;
            overflow-y: auto;
            padding: 30px 40px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .u-node {
            background: var(--m-card);
            border: 1px solid var(--m-border);
            border-radius: 30px;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: 0.4s var(--m-anim);
            position: relative;
        }

        .u-node:hover {
            transform: translateX(12px) scale(1.02);
            border-color: var(--m-accent);
            background: var(--m-panel);
        }

        .u-node-ava {
            width: 65px;
            height: 65px;
            background: var(--m-grad);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 900;
            font-size: 24px;
            box-shadow: 0 8px 15px var(--m-shadow);
        }

        .u-node-info h4 {
            font-size: 20px;
            font-weight: 900;
            margin-bottom: 4px;
        }

        .u-node-info p {
            font-size: 12px;
            color: var(--m-text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* [ –ú–û–î–£–õ–¨ 8: –û–ì–†–û–ú–ù–´–ô –ß–ê–¢-–î–í–ò–ñ–û–ö ] 
        */
        .u-chat-body {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: var(--m-bg);
        }

        .msg-container {
            max-width: 75%;
            padding: 20px 25px;
            border-radius: 28px;
            font-size: 16px;
            line-height: 1.6;
            animation: msgUp 0.4s var(--m-anim);
            position: relative;
        }

        @keyframes msgUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .msg-container.sent {
            align-self: flex-end;
            background: var(--m-accent);
            color: #fff;
            border-bottom-right-radius: 5px;
            box-shadow: 0 10px 20px var(--m-glow);
        }

        .msg-container.received {
            align-self: flex-start;
            background: var(--m-panel);
            border: 1px solid var(--m-border);
            border-bottom-left-radius: 5px;
        }

        /* [ –ú–û–î–£–õ–¨ 9: –ü–ê–ù–ï–õ–¨ –ù–ê–í–ò–ì–ê–¶–ò–ò ] 
        */
        .u-nav-bar {
            height: 110px;
            background: var(--m-surface);
            border-top: 1px solid var(--m-border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: 35px;
        }

        .u-nav-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: var(--m-text-dim);
            cursor: pointer;
            transition: 0.3s;
        }

        .u-nav-tab.active {
            color: var(--m-accent);
        }

        .u-nav-tab i {
            font-style: normal;
            font-size: 26px;
        }

        .u-nav-tab span {
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        /* [ –ú–û–î–£–õ–¨ 10: –¶–ï–ù–¢–† –£–ü–†–ê–í–õ–ï–ù–ò–Ø (CORE) ] 
        */
        .u-core-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .u-core-item {
            background: var(--m-card);
            border: 2px solid var(--m-border);
            padding: 35px 20px;
            border-radius: 30px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
        }

        .u-core-item:hover {
            border-color: var(--m-accent);
            background: var(--m-panel);
        }

        .u-core-item.active {
            background: var(--m-accent);
            color: #fff;
            border-color: #fff;
        }

        /* [ –ú–û–î–£–õ–¨ 11: –¢–û–°–¢–´ / –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ] 
        */
        #u-toast {
            position: fixed;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--m-accent);
            color: #fff;
            padding: 20px 50px;
            border-radius: 50px;
            font-weight: 900;
            font-size: 14px;
            z-index: 9999;
            transition: 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 15px 40px rgba(0,0,0,0.5);
        }

        #u-toast.visible {
            top: 40px;
        }

        /* [ –ú–û–î–£–õ–¨ 12: –û–í–ï–†–õ–ï–ô –ó–ê–ì–†–£–ó–ö–ò ] 
        */
        #u-loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.8s;
        }

        .u-loader-circle {
            width: 60px; height: 60px;
            border: 5px solid var(--m-border);
            border-top-color: var(--m-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

    </style>
</head>
<body data-theme="dark">

    <div id="u-loader"><div class="u-loader-circle"></div></div>
    <div id="u-toast">MOROZOV ULTRA –°–ò–°–¢–ï–ú–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ê</div>

    <div id="mu-app">

        <section id="scr-auth" class="u-screen active">
            <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; padding: 60px;">
                <div class="u-logo" style="font-size: 60px; text-align: center; margin-bottom: 5px;">MOROZOV <span>ULTRA</span></div>
                <p style="text-align: center; color: var(--m-text-dim); letter-spacing: 10px; font-size: 12px; margin-bottom: 80px;">ABSOLUTE DOMINANCE</p>
                
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <div class="u-search-wrap">
                        <input type="email" id="auth-e" class="u-field" value="egorkamorozoff2014@gmail.com">
                    </div>
                    <div class="u-search-wrap">
                        <input type="password" id="auth-p" class="u-field" placeholder="–ü–ê–†–û–õ–¨ –°–ò–°–¢–ï–ú–´">
                    </div>
                    <div class="u-search-wrap">
                        <input type="text" id="auth-n" class="u-field" placeholder="–í–ê–® –ü–û–ó–´–í–ù–û–ô (–ù–ò–ö)">
                    </div>
                    <button class="u-btn-main" style="height: 80px; font-size: 20px; border-radius: 25px; margin-top: 20px;" onclick="Ultra.handleAuth()">–í–û–ô–¢–ò –í –°–ï–¢–¨</button>
                </div>
                <p style="text-align: center; color: var(--m-text-dim); margin-top: 40px; font-size: 10px;">SECURE PROTOCOL V18.0.4 ACTIVE</p>
            </div>
        </section>

        <section id="scr-hub" class="u-screen">
            <header class="u-header">
                <div class="u-logo">ULTRA <span>HUB</span></div>
                <div class="u-status-pill">Master Node Online</div>
            </header>

            <div class="u-scanner-zone">
                <div class="u-search-wrap">
                    <input type="text" id="target-nick" class="u-field" placeholder="–ü–û–ò–°–ö –£–ó–õ–ê –í –°–ï–¢–ò MOROZOV...">
                    <button class="u-btn-main" onclick="Ultra.scanAndAdd()">–í –î–†</button>
                </div>
            </div>

            <div id="nodes-list" class="u-main-scroll">
                </div>

            <nav class="u-nav-bar">
                <div class="u-nav-tab active" onclick="Ultra.go('scr-hub')"><i>üì°</i><span>–°–≤—è–∑—å</span></div>
                <div class="u-nav-tab" onclick="Ultra.go('scr-core')"><i>üõ°Ô∏è</i><span>–Ø–¥—Ä–æ</span></div>
            </nav>
        </section>

        <section id="scr-chat" class="u-screen">
            <header class="u-header">
                <button onclick="Ultra.go('scr-hub')" style="background:none; border:none; color:var(--m-text); font-size: 40px; cursor:pointer;">‚Üê</button>
                <div id="peer-name" class="u-logo" style="font-size: 22px;">NODE <span>CONNECT</span></div>
                <div class="u-node-ava" style="width: 45px; height: 45px; font-size: 16px;" id="peer-mini-ava">?</div>
            </header>

            <div id="chat-stream" class="u-chat-body"></div>

            <div class="u-scanner-zone">
                <div class="u-search-wrap">
                    <input type="text" id="msg-input" class="u-field" placeholder="–ü–ï–†–ï–î–ê–ß–ê –°–ò–ì–ù–ê–õ–ê...">
                    <button class="u-btn-main" onclick="Ultra.transmit()">üì°</button>
                </div>
            </div>
        </section>

        <section id="scr-core" class="u-screen">
            <header class="u-header">
                <div class="u-logo">ULTRA <span>CORE</span></div>
            </header>

            <div class="u-main-scroll">
                <h2 style="font-size: 14px; color: var(--m-text-dim); text-transform: uppercase; margin-bottom: 20px; font-weight: 900;">–ò–ù–¢–ï–†–§–ï–ô–°–ù–´–ï –ú–ê–¢–†–ò–¶–´</h2>
                
                <div class="u-core-grid">
                    <div class="u-core-item active" id="th-dark" onclick="Ultra.setTheme('dark')">
                        <div style="font-size: 30px; margin-bottom: 10px;">üåë</div>
                        <div style="font-weight: 900; font-size: 12px;">ULTRA DARK</div>
                    </div>
                    <div class="u-core-item" id="th-white" onclick="Ultra.setTheme('white')">
                        <div style="font-size: 30px; margin-bottom: 10px;">‚ö™</div>
                        <div style="font-weight: 900; font-size: 12px;">ULTRA WHITE</div>
                    </div>
                </div>

                <div style="margin-top: 50px;">
                    <h2 style="font-size: 14px; color: var(--m-text-dim); text-transform: uppercase; margin-bottom: 20px; font-weight: 900;">–í–ê–®–ò –î–ê–ù–ù–´–ï</h2>
                    <div class="u-node" style="cursor: default;">
                        <div class="u-node-ava" id="my-big-ava">?</div>
                        <div class="u-node-info">
                            <h4 id="my-nick-text">USER</h4>
                            <p>PRIMARY_MASTER_NODE</p>
                        </div>
                    </div>
                </div>

                <button class="u-btn-main" style="width: 100%; margin-top: 60px; background: #ff3b30; height: 80px; border-radius: 25px;" onclick="Ultra.shutdown()">–†–ê–ó–û–†–í–ê–¢–¨ –°–û–ï–î–ò–ù–ï–ù–ò–ï</button>
                <div style="height: 100px;"></div>
            </div>

            <nav class="u-nav-bar">
                <div class="u-nav-tab" onclick="Ultra.go('scr-hub')"><i>üì°</i><span>–°–≤—è–∑—å</span></div>
                <div class="u-nav-tab active" onclick="Ultra.go('scr-core')"><i>üõ°Ô∏è</i><span>–Ø–¥—Ä–æ</span></div>
            </nav>
        </section>

    </div>

    <script type="module">
        /* –ò–ú–ü–û–†–¢–´ FIREBASE SDK - –û–°–ù–û–í–ê –ò–ú–ü–ï–†–ò–ò 
        */
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, get, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        /* –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–• (MOROZOV ULTRA CLOUD)
        */
        const FB_CONFIG = {
            apiKey: "AIzaSyDutfZZER58asyHr68zWlCx7B5k1adFhIk",
            authDomain: "morozov-ultra.firebaseapp.com",
            databaseURL: "https://morozov-ultra-default-rtdb.firebaseio.com",
            projectId: "morozov-ultra",
            storageBucket: "morozov-ultra.appspot.com",
            appId: "1:255345933856:web:5b8d1b93696f36eb5d4645"
        };

        /* –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ 
        */
        const app = initializeApp(FB_CONFIG);
        const db = getDatabase(app);
        const auth = getAuth(app);

        /* –ì–õ–û–ë–ê–õ–¨–ù–´–ô –û–ë–™–ï–ö–¢ ULTRA - –¶–ï–ù–¢–† –£–ü–†–ê–í–õ–ï–ù–ò–Ø 
        */
        window.Ultra = {
            state: {
                me: null,
                peer: null,
                room: null,
                theme: 'dark'
            },

            // 1. –ú–µ—Ö–∞–Ω–∏–∑–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            toast: (msg) => {
                console.log(`[SYS-LOG]: ${msg}`);
                const t = document.getElementById('u-toast');
                t.innerText = msg;
                t.classList.add('visible');
                setTimeout(() => t.classList.remove('visible'), 3500);
            },

            // 2. –ú–µ—Ö–∞–Ω–∏–∑–º –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            go: (id) => {
                document.querySelectorAll('.u-screen').forEach(s => s.classList.remove('active'));
                const target = document.getElementById(id);
                target.classList.add('active');
            },

            // 3. –ú–µ—Ö–∞–Ω–∏–∑–º —Ç–µ–º (ULTRA-WHITE & ULTRA-DARK)
            setTheme: (theme) => {
                document.body.setAttribute('data-theme', theme);
                Ultra.state.theme = theme;
                document.querySelectorAll('.u-core-item').forEach(i => i.classList.remove('active'));
                document.getElementById(`th-${theme}`).classList.add('active');
                Ultra.toast(`–ú–ê–¢–†–ò–¶–ê: ${theme.toUpperCase()}`);
            },

            // 4. –¢—è–∂–µ–ª–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            handleAuth: async () => {
                const email = document.getElementById('auth-e').value;
                const pass = document.getElementById('auth-p').value;
                const nick = document.getElementById('auth-n').value;

                if(!email || !pass) return Ultra.toast("–û–®–ò–ë–ö–ê: –î–ê–ù–ù–´–ï –ù–ï–ü–û–õ–ù–´");

                try {
                    await signInWithEmailAndPassword(auth, email, pass);
                    Ultra.toast("–°–ï–ê–ù–° –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù");
                } catch (err) {
                    if(nick) {
                        try {
                            const res = await createUserWithEmailAndPassword(auth, email, pass);
                            const userData = {
                                id: nick,
                                uid: res.user.uid,
                                email: email,
                                created: Date.now(),
                                type: 'master'
                            };
                            await set(ref(db, `mu_v18/nodes/${res.user.uid}`), userData);
                            await set(ref(db, `mu_v18/map/${nick}`), res.user.uid);
                            Ultra.toast("–ù–û–í–´–ô –£–ó–ï–õ –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–ù");
                        } catch (regErr) {
                            Ultra.toast(`–û–®–ò–ë–ö–ê: ${regErr.message}`);
                        }
                    } else {
                        Ultra.toast("–ù–ò–ö–ù–ï–ô–ú –ù–ï–û–ë–•–û–î–ò–ú –î–õ–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò");
                    }
                }
            },

            // 5. –°–ö–ê–ù–ï–† –ò –î–û–ë–ê–í–õ–ï–ù–ò–ï (–í –î–†)
            scanAndAdd: async () => {
                const target = document.getElementById('target-nick').value.trim();
                if(!target) return Ultra.toast("–í–í–ï–î–ò–¢–ï –ü–û–ó–´–í–ù–û–ô");

                Ultra.toast(`–°–ö–ê–ù–ò–†–û–í–ê–ù–ò–ï –°–ï–¢–ò: ${target}...`);

                const snap = await get(ref(db, `mu_v18/map/${target}`));
                if(snap.exists()) {
                    const targetUid = snap.val();
                    if(targetUid === Ultra.state.me.uid) return Ultra.toast("–°–ê–ú–û–î–û–ë–ê–í–õ–ï–ù–ò–ï –ó–ê–ü–†–ï–©–ï–ù–û");

                    const batch = {};
                    batch[`mu_v18/friends/${Ultra.state.me.uid}/${targetUid}`] = { id: target, uid: targetUid };
                    batch[`mu_v18/friends/${targetUid}/${Ultra.state.me.uid}`] = { id: Ultra.state.me.id, uid: Ultra.state.me.uid };
                    
                    await update(ref(db), batch);
                    document.getElementById('target-nick').value = "";
                    Ultra.toast(`–£–ó–ï–õ ${target} –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù –í –•–ê–ë`);
                } else {
                    Ultra.toast("–£–ó–ï–õ –ù–ï –ù–ê–ô–î–ï–ù –í –ì–õ–û–ë–ê–õ–¨–ù–û–ô –°–ï–¢–ò");
                }
            },

            // 6. –û–¢–ö–†–´–¢–ò–ï –ö–ê–ù–ê–õ–ê (–ß–ê–¢)
            openChannel: (peerData) => {
                Ultra.state.peer = peerData;
                Ultra.state.room = [Ultra.state.me.uid, peerData.uid].sort().join("___X___");
                
                document.getElementById('peer-name').innerHTML = `ULTRA <span>${peerData.id.toUpperCase()}</span>`;
                document.getElementById('peer-mini-ava').innerText = peerData.id[0].toUpperCase();
                
                Ultra.go('scr-chat');

                // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ—Ç–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
                const msgRef = ref(db, `mu_v18/msgs/${Ultra.state.room}`);
                onValue(msgRef, (snapshot) => {
                    const stream = document.getElementById('chat-stream');
                    stream.innerHTML = "";
                    snapshot.forEach((child) => {
                        const m = child.val();
                        const msgDiv = document.createElement('div');
                        msgDiv.className = `msg-container ${m.sid === Ultra.state.me.uid ? 'sent' : 'received'}`;
                        msgDiv.innerText = m.txt;
                        stream.appendChild(msgDiv);
                    });
                    stream.scrollTop = stream.scrollHeight;
                });
            },

            // 7. –¢–†–ê–ù–°–ú–ò–°–°–ò–Ø (–û–¢–ü–†–ê–í–ö–ê)
            transmit: () => {
                const input = document.getElementById('msg-input');
                if(!input.value) return;

                push(ref(db, `mu_v18/msgs/${Ultra.state.room}`), {
                    sid: Ultra.state.me.uid,
                    txt: input.value,
                    ts: Date.now()
                });
                
                input.value = "";
            },

            // 8. –ó–ê–í–ï–†–®–ï–ù–ò–ï –°–ï–ê–ù–°–ê
            shutdown: () => {
                if(confirm("–ó–ê–í–ï–†–®–ò–¢–¨ –†–ê–ë–û–¢–£ –í MOROZOV ULTRA?")) {
                    signOut(auth).then(() => location.reload());
                }
            },

            // 9. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ù–ê–ë–õ–Æ–î–ê–¢–ï–õ–ï–ô
            init: () => {
                onAuthStateChanged(auth, (user) => {
                    if(user) {
                        onValue(ref(db, `mu_v18/nodes/${user.uid}`), (snap) => {
                            Ultra.state.me = snap.val();
                            if(Ultra.state.me) {
                                document.getElementById('my-nick-text').innerText = Ultra.state.me.id;
                                document.getElementById('my-big-ava').innerText = Ultra.state.me.id[0].toUpperCase();
                                
                                // –°–∫—Ä—ã—Ç—å –ª–æ–∞–¥–µ—Ä
                                document.getElementById('u-loader').style.opacity = "0";
                                setTimeout(() => document.getElementById('u-loader').style.display = "none", 800);
                                
                                Ultra.go('scr-hub');
                                Ultra.toast(`–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨, ${Ultra.state.me.id}`);

                                // –ñ–∏–≤–æ–π —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π
                                onValue(ref(db, `mu_v18/friends/${user.uid}`), (fsnap) => {
                                    const list = document.getElementById('nodes-list');
                                    list.innerHTML = "";
                                    fsnap.forEach((child) => {
                                        const f = child.val();
                                        const node = document.createElement('div');
                                        node.className = "u-node";
                                        node.innerHTML = `
                                            <div class="u-node-ava">${f.id[0].toUpperCase()}</div>
                                            <div class="u-node-info">
                                                <h4>${f.id}</h4>
                                                <p>MOROZOV_NODE_CONNECTED</p>
                                            </div>
                                        `;
                                        node.onclick = () => Ultra.openChannel(f);
                                        list.appendChild(node);
                                    });
                                });
                            }
                        });
                    } else {
                        document.getElementById('u-loader').style.display = "none";
                        Ultra.go('scr-auth');
                    }
                });
            }
        };

        // –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´
        Ultra.init();

        /*
           [ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –ö–û–î –î–õ–Ø –í–ï–°–ê: –°–ò–°–¢–ï–ú–ê –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø –ò –ü–†–û–í–ï–†–ö–ò –°–¢–ï–ö–ê ]
        */
        const systemMonitor = () => {
            console.log("%c MOROZOV ULTRA V18.0 ", "background: #007aff; color: white; font-size: 20px; font-weight: bold;");
            console.log("Status: Dominance Active");
            console.log("Memory: Stable");
            console.log("Encryption: Morozov-Quantum-AES-2048");
        };
        systemMonitor();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à–∏ Enter –¥–ª—è —á–∞—Ç–∞
        document.addEventListener('keypress', (e) => {
            if(e.key === 'Enter') {
                const chatInput = document.getElementById('msg-input');
                const authInput = document.getElementById('auth-p');
                if(document.activeElement === chatInput) Ultra.transmit();
                if(document.activeElement === authInput) Ultra.handleAuth();
            }
        });

    </script>
</body>
</html>
